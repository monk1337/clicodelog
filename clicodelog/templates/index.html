<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Conversation History</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@400,500,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/variables.css">
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link rel="stylesheet" href="/static/css/list.css">
    <link rel="stylesheet" href="/static/css/messages.css">
    <link rel="stylesheet" href="/static/css/controls.css">
    <link rel="stylesheet" href="/static/css/search.css">
    <link rel="stylesheet" href="/static/css/tags.css">
    <link rel="stylesheet" href="/static/css/misc.css">
</head>
<body>
    <!-- Top Controls -->
    <div class="top-controls">
        <div class="source-selector">
            <label>Source:</label>
            <select id="source-select" onchange="changeSource(this.value)">
                <option value="claude-code">Claude Code</option>
                <option value="codex">OpenAI Codex</option>
                <option value="gemini">Google Gemini</option>
            </select>
        </div>
        <span class="sync-status" id="sync-status" title="Last sync time">Syncing...</span>
        <button class="control-btn" id="thinking-toggle-btn" onclick="toggleAllThinking()" title="Toggle all thinking blocks">
            <span class="icon">üß†</span>
            <span>Show Thinking</span>
        </button>
        <button class="control-btn" id="search-btn" onclick="toggleSearch()" title="Search conversations">
            <span class="icon">üîç</span>
            <span>Search</span>
        </button>
        <button class="control-btn" id="copy-btn" onclick="copyConversation()" title="Copy conversation to clipboard" disabled>
            <span class="icon">üìã</span>
            <span>Copy</span>
        </button>
        <button class="control-btn" id="export-btn" onclick="exportConversation()" title="Export conversation as TXT" disabled>
            <span class="icon">üì•</span>
            <span>Export</span>
        </button>
        <button class="control-btn" id="sync-btn" onclick="manualSync()" title="Sync data now">
            <span class="icon">üîÑ</span>
            <span>Sync</span>
        </button>
        <button class="control-btn" onclick="toggleTheme()" title="Toggle theme">
            <span class="icon" id="theme-icon">üåô</span>
            <span id="theme-label">Dark</span>
        </button>
    </div>

    <!-- Search Modal -->
    <div class="search-modal" id="search-modal">
        <div class="search-modal-header">
            <h3>Search Conversations</h3>
            <span class="search-modal-close" onclick="toggleSearch()">‚úï</span>
        </div>
        <div class="search-input-container">
            <input type="text" id="global-search-input" placeholder="Search across all conversations...">
        </div>
        <div class="search-modal-content" id="search-results">
            <div class="no-search-results">Type to search across conversations</div>
        </div>
    </div>

    <div class="app">
        <!-- Projects Panel -->
        <div class="panel" id="projects-panel" style="width: 280px; min-width: 180px; max-width: 500px; flex-shrink: 0;">
            <div class="panel-header"><h2>Projects</h2></div>
            <div class="search-box">
                <input type="text" id="project-search" placeholder="Search projects...">
            </div>
            <div class="tag-filter-bar" id="tag-filter-bar"></div>
            <div class="panel-content" id="projects-list">
                <div class="loading"><div class="spinner"></div>Loading projects...</div>
            </div>
        </div>

        <div class="resize-handle" id="resize-handle-1"></div>

        <!-- Sessions Panel -->
        <div class="panel" id="sessions-panel" style="width: 320px; min-width: 200px; max-width: 600px; flex-shrink: 0;">
            <div class="panel-header"><h2>Sessions</h2></div>
            <div class="session-filters" id="session-filters" style="display: none;">
                <select id="filter-size" onchange="applySessionFilters()">
                    <option value="all">Size: All</option>
                    <option value="<10KB">&lt;10KB</option>
                    <option value="10-100KB">10-100KB</option>
                    <option value="100KB-1MB">100KB-1MB</option>
                    <option value=">1MB">&gt;1MB</option>
                </select>
                <select id="filter-date" onchange="applySessionFilters()">
                    <option value="all">Date: All</option>
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                    <option value="older">Older</option>
                </select>
                <select id="filter-sort" onchange="applySessionFilters()">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="largest">Largest First</option>
                    <option value="messages">Most Messages</option>
                </select>
                <button class="filter-reset-btn" onclick="resetSessionFilters()">Reset</button>
            </div>
            <div class="panel-content" id="sessions-list">
                <div class="empty-state">
                    <div class="empty-state-icon">üìÅ</div>
                    <p>Select a project to view sessions</p>
                </div>
            </div>
        </div>

        <div class="resize-handle" id="resize-handle-2"></div>

        <!-- Conversation Panel -->
        <div class="panel conversation-panel" id="conversation-panel" style="flex: 1; min-width: 300px;">
            <div class="conv-filter-bar" id="conv-filter-bar" style="display:none">
                <div class="role-filter-group">
                    <button class="role-btn" data-filter="user" onclick="toggleRoleFilter('user')">User</button>
                    <button class="role-btn" data-filter="assistant" onclick="toggleRoleFilter('assistant')">AI</button>
                    <button class="role-btn" data-filter="tools" onclick="toggleRoleFilter('tools')">Tools</button>
                </div>
                <div class="conv-nav-btns">
                    <button class="conv-ctrl-btn" onclick="scrollConvToTop()" title="Scroll to top">&#8593; Top</button>
                    <button class="conv-ctrl-btn" onclick="scrollConvToBottom()" title="Scroll to bottom">&#8595; End</button>
                </div>
            </div>
            <div id="conversation-content">
                <div class="empty-state">
                    <div class="empty-state-icon">üí¨</div>
                    <h3>AI Conversation History</h3>
                    <p>Select a session to view the conversation</p>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/state.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/theme.js"></script>
    <script src="/static/js/resize.js"></script>
    <script src="/static/js/tags.js"></script>
    <script src="/static/js/sync.js"></script>
    <script src="/static/js/projects.js"></script>
    <script src="/static/js/sessions.js"></script>
    <script src="/static/js/conversation.js"></script>
    <script src="/static/js/search.js"></script>
    <script src="/static/js/clipboard.js"></script>
    <script src="/static/js/main.js"></script>
</body>
</html>
